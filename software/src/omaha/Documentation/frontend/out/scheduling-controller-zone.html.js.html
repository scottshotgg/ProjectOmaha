<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: scheduling-controller-zone.html.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: scheduling-controller-zone.html.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>
	var timingDataArrayZone = [];
	var schedulingModeZone;
	var speakerForScheduling;
	var ssZone;

	var day = new Date().getDay();

	var myChart_timingZone; 

	var canvas_timingZone = document.getElementById("timingChartZone");
	var chart_width_scalar_timing = .8;
	var chart_height_scalar_timing = .52;

	/**
	 * This function is the zone version of drawBasic.
 	 * This function is used to draw the basic scheduling card.
	 */
	function drawBasicZone() {
		ssZone.schedulingSelectorZone.selected = "basic";

		var localWidthZone = $(window).width() * .20;
		var localHeightZone = $(window).height() * .5;
		
		document.getElementById("card-contentZone").style.width = localWidthZone + "px";
		document.getElementById("card-contentZone").style.height = localHeightZone + "px";

		//console.log(speaker);


	  loadDayOutsideZone();
	}

	/**
	 * This function is the zone version of drawAdvanced.
	 * This function is used to draw the advanced scheduling card.
	 */
	function drawAdvancedZone() {
		canvas_timingZone = document.getElementById("timingChartZone");
		//console.log(canvas_timingZone);
		ssZone.schedulingSelectorZone.selected = "advanced";

	  var localWidthZone = $(window).width() * .82;
		var localHeightZone = ($(window).height() + 36) * .62;

		document.getElementById("card-contentZone").style.width = localWidthZone + "px";
		document.getElementById("card-contentZone").style.height = localHeightZone + "px";

	  canvas_timingZone = document.getElementById("timingChartZone");
	  canvas_timingZone.width = $(window).width() * chart_width_scalar_timing;
	  canvas_timingZone.height = $(window).height() * chart_height_scalar_timing;

	  timingDataArrayZone = zones[0].Schedule[ssZone.dayListboxZone.selected].slice(4, 28);

	  $(document.getElementsByClassName("timesZone")).each(function(i) {
	    this.value = timingDataArrayZone[i];
	  });

	  var timingData = {
	    labels: timingLabels,
	    datasets: [{
	      fillColor: "rgba(63, 81, 181, 0.25)",
	      strokeColor: "#3f51b5",
	      pointColor: "#fff",
	      pointStrokeColor: "#3f51b5",  
	      data: timingDataArrayZone
	    }]
	  };

	  //console.log(timingDataArrayZone);


	  loadDayOutsideZone();
	}

	$(window).resize(function() {
		if(schedulingModeZone.selected == "advanced") {
	    redrawTimingOnInputZone()
	 	}

	});

	var timingLabels = ["00:00", "01:00", "02:00", "03:00", "04:00", "05:00", "06:00", "07:00", "08:00", "09:00", "10:00", "11:00", "12:00", "13:00", "14:00", "15:00", "16:00", "17:00", "18:00", "19:00", "20:00", "21:00", "22:00", "23:00", "24:00"];

	var timingData = {
	  labels: timingLabels,
	  datasets: [{
	    fillColor: "rgba(63, 81, 181, 0.25)",
	    strokeColor: "#3f51b5",
	    pointColor: "#fff",
	    pointStrokeColor: "#3f51b5",  
	    data: timingDataArrayZone
	  }]
	};

	var timingLineAttributes = {
	  scaleOverride: true,
	  scaleSteps: 10,   
		scaleLabel: "&lt;%= value + \"%\" %>",
	  scaleStartValue: 0,
	  scaleStepWidth: 10,
	  scaleShowLabels: true,
	  scaleFontSize: 12,
	};


	var timingResizeLineAttributes = {
	  animation: false,
	  scaleOverride: true,
	  scaleSteps: 10,
		scaleLabel: "&lt;%= value + \"%\" %>",
	  scaleStartValue: 0,
	  scaleStepWidth: 10,
	  scaleShowLabels: true,
	  scaleFontSize: 12,
	};

	var timingRedrawLineAttributes = {
	  showTooltips: true,
	  scaleOverride: true,
	  scaleSteps: 10,
		scaleLabel: "&lt;%= value + \"%\" %>",
	  scaleStartValue: 0,
	  scaleStepWidth: 10,
	  scaleShowLabels: true,
	  scaleFontSize: 12,
	};

	Polymer({
	    is: 'scheduling-controller-zone',

	    behaviors: [
	      Polymer.NeonAnimatableBehavior
	    ],

	    properties: {

	      speaker: {
	        type: Object
	      },

	    	animationConfig: {
	        value: function() {
	          return {
	            'entry': {
	                name: 'fade-in-animation',
	                node: this
	              },
	            'exit': {
	              name: 'slide-left-animation',
	              node: this
	            }
	          }
	        }
	      }
	    },

	    loadDayZone: loadDayOutsideZone,

	    /**
	     * This function is the zone version of scheduleTime.
       * ScheduleTime is used to apply a new timing schedule to a speaker. 
	     */
	    scheduleTimeZone: function() {

	    	//console.log(this.$.intervalListboxZone.selected);

	      var scheduleTimeAjaxZone = document.querySelector("#scheduleTimeAjaxZone");

	      if(schedulingModeZone.selected == "advanced") {
			    var timesZone = document.getElementsByClassName("timesZone");
					var timesArrayZone = [];
					for (var i = 0; i &lt; timesZone.length; i++) {
						var timesParse = parseInt(times[i].value);

						if(isNaN(timesParse)) {
							return;
						}
						timesArrayZone.push(timesParse);
					}

					scheduleTimeAjaxZone.body = {
						"zone" 			: speaker.zone.zoneID,
						"mode"			: 1,
						"start"			: -1,
						"end"				: -1,
						"day" 			: parseInt(this.$.dayListboxZone.selected),
						"interval"	: 60,
						"times" 		:	timesArrayZone
					};

					scheduleTimeAjaxZone.generateRequest();
	      } else if(schedulingModeZone.selected == "basic") {
	      	var upTime = this.$.upTimeListBoxZone.selected;
	      	var downTime = this.$.downTimeListBoxZone.selected;
	      	//console.log("this is the interval", this.$.interval);

	      	var timesArrayZone = [];
	      	rampUpLevel = this.$.rampUpLevelListboxZone.selected
	      	rampDownLevel = this.$.rampDownLevelListboxZone.selected
	      	var i = 0;
	      	for(i = 0; i &lt; upTime; i++) {
	      		timesArrayZone.push(rampDownLevel * 10);
	      	}	
	      	for(i; i &lt; downTime; i++) {
	      		timesArrayZone.push(rampUpLevel * 10);
	      	}
	      	for(i; i &lt; 24; i++) {
	      		timesArrayZone.push(rampDownLevel * 10);
	      	}

					scheduleTimeAjaxZone.body = {
						"zone" 			: speaker.zone.zoneID, 
						"mode"			: 0,
						"start"			: parseInt(this.$.upTimeListBoxZone.selected),
						"end"				: parseInt(this.$.downTimeListBoxZone.selected),
						"day" 			: parseInt(this.$.dayListboxZone.selected),
						"interval"	: parseInt(this.$.intervalListboxZone.selected),
						"times" 		:	timesArrayZone
					};

					scheduleTimeAjaxZone.generateRequest();

	      	//console.log(timesArrayZone);
	      }
		  },

	  	redrawTimingOnInputZone: redrawTimingOnInputZone,

	  	_logResponse: function(event, data) {
	  		//console.log(data.response);
	  	},

	    ready: function() {
	    	//console.log("THIS IS THE DAY", day);
	    	this.$.dayListboxZone.selected = day;
	    	//console.log(this.$.dayListboxZone.selected);
	    	schedulingModeZone = this.$.schedulingSelectorZone; 
	    	//console.log("i have read the selected value", schedulingModeZone); 	
	    	//console.log(schedulingModeZone);
	    	//console.log("im the ready selected  ", this.$);

				//console.log(this.zone);
				ssZone = this.$;

	    }

	  });

	/**
	 * This is the zone version of the loadDayOutside function.
 	 * This function is used to load the selectors with the correct values for that day.
	 */
	function loadDayOutsideZone() {
		//console.log(ss);

		var selectedDay = ssZone.dayListboxZone.selected;
		//console.log("day" + selectedDay);
		//console.log(ssZone.schedulingSelectorZone.selected);
		if(ssZone.schedulingSelectorZone.selected == "basic") {
			if(zones[speaker.zone.zoneID - 1].Schedule[selectedDay][2] != -1 || zones[speaker.zone.zoneID - 1].Schedule[selectedDay][3] != -1) {
				ssZone.upTimeListBoxZone.selected = zones[speaker.zone.zoneID - 1].Schedule[selectedDay][2];
				ssZone.downTimeListBoxZone.selected = zones[speaker.zone.zoneID - 1].Schedule[selectedDay][3];

				ssZone.rampUpLevelListboxZone.selected = zones[speaker.zone.zoneID - 1].Schedule[selectedDay][zones[speaker.zone.zoneID - 1].Schedule[selectedDay][2] + 4] / 10;
				ssZone.rampDownLevelListboxZone.selected = zones[speaker.zone.zoneID - 1].Schedule[selectedDay][zones[speaker.zone.zoneID - 1].Schedule[selectedDay][3] + 4] / 10;
				ssZone.intervalListboxZone.selected = zones[speaker.zone.zoneID - 1].Schedule[selectedDay][1];
			} else {
				ssZone.upTimeListBoxZone.selected = -1;
				ssZone.downTimeListBoxZone.selected = -1;
				ssZone.rampUpLevelListboxZone.selected = -1;
				ssZone.rampDownLevelListboxZone.selected = -1;
				ssZone.intervalListboxZone.selected = -1;
			}
		} else if(ssZone.schedulingSelectorZone.selected == "advanced") {
			timingDataArrayZone = zones[speaker.zone.zoneID - 1].Schedule[selectedDay].slice(4, 29);
			var times = document.getElementsByClassName("timesZone");

			for(var x = 0; x &lt; timingDataArrayZone.length; x++) {
				times[x].value = timingDataArrayZone[x];
				times[x + 1].value = timingDataArrayZone[0];
			}
			redrawTimingOnInputZone()

			//console.log(timingDataArrayZone);
		} else {
			alert("i hava make a break");
		}
	}

	/**
	 * This is the zone version of redrawTiming.
	 * This function is used to redraw the graph.
	 */
	function redrawTimingZone(drawingData, drawingLineAttributes) {
		//console.log("I got here");
		$($(canvas_timingZone).parent()).prepend("&lt;canvas id=\"timingChartZone\" style=\"margin-left: calc(.02 * 100vh); margin-right: calc(.02 * 100vh); margin-top: calc(.02 * 100vh);\" class=\"chartClass\">&lt;/canvas>");

		//console.log("now im here");

	  canvas_timingZone.remove();		

	  var localWidthZone = $(window).width() * .82;
		var localHeightZone = ($(window).height() + 36) * .62;

		document.getElementById("card-contentZone").style.width = localWidthZone + "px";
		document.getElementById("card-contentZone").style.height = localHeightZone + "px";

	  canvas_timingZone = document.getElementById("timingChartZone");
	  canvas_timingZone.width = $(window).width() * chart_width_scalar_timing;
	  canvas_timingZone.height = $(window).height() * chart_height_scalar_timing;

	  //console.log("i think im here");

	  //console.log(timingDataArrayZone);

	  myChart_timingZone = new Chart(canvas_timingZone.getContext("2d")).Line(drawingData, drawingLineAttributes);

	  //console.log("and now im here...");
	}

	/**
	 * This is the zone version of redrawTimingOnInput.
   * This function is fired on input into the text box. It validates the data that is input and changes the graph to red if something is detected as invalid.
	 */
	function redrawTimingOnInputZone() {
	  var errorAdjustToastZone = document.getElementById("errorAdjustToastZone");
	  var strokeColor = "#3f51b5";
	  var pointStrokeColor = "#3f51b5";
	  var fillColor = "rgba(63, 81, 181, .25)";

	  //console.log("redrawTimingOnInputZone");

	  $(document.getElementsByClassName("timesZone")).each(function(i) {
	  	//console.log(i, this.value);

	    if(this.value > -1 &amp;&amp; this.value &lt; 101 &amp;&amp; this.value !== "") {
	    	//console.log("in the bigger One");
	      timingDataArrayZone[i] = parseInt(this.value);
	    } else {
	    	//console.log("not in the bigger one");
	      timingDataArrayZone[i] = null;
	      
	      // Set the error colors
	      strokeColor = "#F33F31";
	      pointStrokeColor = "#F33F31";
	      fillColor = "rgba(243, 63, 49, .25)";

	      if(isNaN(this.value)) {
	        errorAdjustToastZone.text = "Invalid entry for " + timingLabels[i] + "Hz: Only numerical values are accepted";
	        errorAdjustToastZone.show();
	      } else if (this.value === "") {

	      } else {
	        errorAdjustToastZone.text = "Invalid entry for " + timingLabels[i] + "Hz: Accepted range of values is -20 to 80";
	        errorAdjustToastZone.show();
	      }
	    }
	  });

	  var timingRedrawData = {
	    labels: timingLabels,
	    datasets: [{
	      fillColor: fillColor,
	      strokeColor: strokeColor,
	      pointColor: "#fff",
	      pointStrokeColor: pointStrokeColor,  
	      data: timingDataArrayZone,
	      }]
	  };

	  redrawTimingZone(timingRedrawData, timingRedrawLineAttributes);
	}

</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#_acceptPressed">_acceptPressed</a></li><li><a href="global.html#_acceptPressedZone">_acceptPressedZone</a></li><li><a href="global.html#_cancelPressed">_cancelPressed</a></li><li><a href="global.html#_cancelPressedZone">_cancelPressedZone</a></li><li><a href="global.html#_cancelSwitchPressed">_cancelSwitchPressed</a></li><li><a href="global.html#_cancelSwitchPressedZone">_cancelSwitchPressedZone</a></li><li><a href="global.html#_closeDrawer">_closeDrawer</a></li><li><a href="global.html#_equalizerUpdate">_equalizerUpdate</a></li><li><a href="global.html#_handleLogin">_handleLogin</a></li><li><a href="global.html#_initializeStatus">_initializeStatus</a></li><li><a href="global.html#_keepAliveResponse">_keepAliveResponse</a></li><li><a href="global.html#_logResponse">_logResponse</a></li><li><a href="global.html#_pagingUpdate">_pagingUpdate</a></li><li><a href="global.html#_presetSelectionChanged">_presetSelectionChanged</a></li><li><a href="global.html#_presetSelectionChangedZone">_presetSelectionChangedZone</a></li><li><a href="global.html#_selectionChanged">_selectionChanged</a></li><li><a href="global.html#_selectSpeaker">_selectSpeaker</a></li><li><a href="global.html#_selectZone">_selectZone</a></li><li><a href="global.html#_setEqualizerClicked">_setEqualizerClicked</a></li><li><a href="global.html#_setEqualizerClickedZone">_setEqualizerClickedZone</a></li><li><a href="global.html#_setInternalEqualizer">_setInternalEqualizer</a></li><li><a href="global.html#_setInternalPaging">_setInternalPaging</a></li><li><a href="global.html#_setInternalTarget">_setInternalTarget</a></li><li><a href="global.html#_setInternalVolume">_setInternalVolume</a></li><li><a href="global.html#_setPagingClicked">_setPagingClicked</a></li><li><a href="global.html#_setTargetClicked">_setTargetClicked</a></li><li><a href="global.html#_setTargetClickedZone">_setTargetClickedZone</a></li><li><a href="global.html#_setVolumeClicked">_setVolumeClicked</a></li><li><a href="global.html#_showMap">_showMap</a></li><li><a href="global.html#_speakerSelected">_speakerSelected</a></li><li><a href="global.html#_submit">_submit</a></li><li><a href="global.html#_switchPressed">_switchPressed</a></li><li><a href="global.html#_switchPressedZone">_switchPressedZone</a></li><li><a href="global.html#_targetUpdate">_targetUpdate</a></li><li><a href="global.html#_toggleDrawer">_toggleDrawer</a></li><li><a href="global.html#_volumeUpdate">_volumeUpdate</a></li><li><a href="global.html#_zoneSelected">_zoneSelected</a></li><li><a href="global.html#adjustSize">adjustSize</a></li><li><a href="global.html#decrementEffectiveness">decrementEffectiveness</a></li><li><a href="global.html#decrementMaskingVolume">decrementMaskingVolume</a></li><li><a href="global.html#decrementMusicVolume">decrementMusicVolume</a></li><li><a href="global.html#decrementPagingVolume">decrementPagingVolume</a></li><li><a href="global.html#decrementPleasantnesss">decrementPleasantnesss</a></li><li><a href="global.html#decrementVolume">decrementVolume</a></li><li><a href="global.html#drawAdvanced">drawAdvanced</a></li><li><a href="global.html#drawAdvancedZone">drawAdvancedZone</a></li><li><a href="global.html#drawBasic">drawBasic</a></li><li><a href="global.html#drawBasicZone">drawBasicZone</a></li><li><a href="global.html#findZoneIndex">findZoneIndex</a></li><li><a href="global.html#getValues">getValues</a></li><li><a href="global.html#getValuesZone">getValuesZone</a></li><li><a href="global.html#incrementEffectiveness">incrementEffectiveness</a></li><li><a href="global.html#incrementMaskingVolume">incrementMaskingVolume</a></li><li><a href="global.html#incrementMusicVolume">incrementMusicVolume</a></li><li><a href="global.html#incrementPagingVolume">incrementPagingVolume</a></li><li><a href="global.html#incrementPleasantnesss">incrementPleasantnesss</a></li><li><a href="global.html#incrementVolume">incrementVolume</a></li><li><a href="global.html#inputChanged">inputChanged</a></li><li><a href="global.html#inputChangedZone">inputChangedZone</a></li><li><a href="global.html#loadDayOutside">loadDayOutside</a></li><li><a href="global.html#loadDayOutsideZone">loadDayOutsideZone</a></li><li><a href="global.html#merge">merge</a></li><li><a href="global.html#mergeSort">mergeSort</a></li><li><a href="global.html#modeChanged">modeChanged</a></li><li><a href="global.html#modeChangedZone">modeChangedZone</a></li><li><a href="global.html#pulsateCircle">pulsateCircle</a></li><li><a href="global.html#ready">ready</a></li><li><a href="global.html#redraw">redraw</a></li><li><a href="global.html#redrawOnInput">redrawOnInput</a></li><li><a href="global.html#redrawOnInputZone">redrawOnInputZone</a></li><li><a href="global.html#redrawTiming">redrawTiming</a></li><li><a href="global.html#redrawTimingOnInput">redrawTimingOnInput</a></li><li><a href="global.html#redrawTimingOnInputZone">redrawTimingOnInputZone</a></li><li><a href="global.html#redrawTimingZone">redrawTimingZone</a></li><li><a href="global.html#redrawZone">redrawZone</a></li><li><a href="global.html#refreshMap">refreshMap</a></li><li><a href="global.html#renderMap">renderMap</a></li><li><a href="global.html#renderPagingMap">renderPagingMap</a></li><li><a href="global.html#resetKnob">resetKnob</a></li><li><a href="global.html#saveDefault">saveDefault</a></li><li><a href="global.html#scheduleTime">scheduleTime</a></li><li><a href="global.html#scheduleTimeZone">scheduleTimeZone</a></li><li><a href="global.html#setUI">setUI</a></li><li><a href="global.html#showEqualizerSwitchDialog">showEqualizerSwitchDialog</a></li><li><a href="global.html#showEqualizerSwitchDialogZone">showEqualizerSwitchDialogZone</a></li><li><a href="global.html#showMasking">showMasking</a></li><li><a href="global.html#showPaging">showPaging</a></li><li><a href="global.html#updateMapForError">updateMapForError</a></li><li><a href="global.html#updateViewForSelectedSpeakers">updateViewForSelectedSpeakers</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Fri Jun 17 2016 17:12:26 GMT-0500 (CDT)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
