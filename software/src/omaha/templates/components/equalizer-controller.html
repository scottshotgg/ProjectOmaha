<link rel="import" href="/bower_components/polymer/polymer.html">
<link rel="import" href="/bower_components/iron-flex-layout/classes/iron-flex-layout.html">
<link rel="import" href="/bower_components/iron-icons/iron-icons.html">
<link rel="import" href="/bower_components/paper-card/paper-card.html">
<link rel="import" href="/bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="/bower_components/paper-slider/paper-slider.html">
<link rel="import" href="/bower_components/paper-toast/paper-toast.html">
<link rel="import" href="/bower_components/paper-button/paper-button.html">
  <link rel="stylesheet" href="jquery-ui-1.11.4.css">
  <script type="text/javascript" src="jquery-1.10.2.js"></script>
  <!--<script type="text/javascript" src="jquery-2.2.0.js"></script>-->
  <script type="text/javascript" src="jquery-ui-1.11.4.js"></script>
  <script type="text/javascript" src="jquery.ui.touch-punch.js"></script>

<dom-module id="equalizer-controller">
  <template>
    <style>
      :host {
        display: block;
      }

      #slider {
        width: 100%;
        height: 85%;
        margin-bottom: calc(.03 * 100vh);
      }

      paper-card {
        width: 100%;
         height: 60%;   /* This was 100%, cahnge back if needed */
      }

      .paper-card .card-content {
        padding: 0px;
        height: 150%;
      }
      
      paper-button {
        background-color: #3367d6;
        color: #fff;
        margin-top: 10px;
      }

      .header.paper-card .title-text.paper-card {
        padding: 0px;
      }

    </style>

   <paper-card heading="Equalizer" elevation="4">
      <div class="card-content">
        <div id="slider" class="layout horizontal">
          <div id="custom_container"> 
            <div class="custom one"> <input id="text1" readonly/> <div class="custom_slider" value={{"internalEqualizer"}}></div></div>
            <div class="custom two"> <input id="text2" readonly/> <div class="custom_slider" value={{"equalizer2"}}></div></div>
            <div class="custom three"> <input id="text3" readonly/> <div class="custom_slider" value={{"equalizer3"}}></div></div>
            <div class="custom four"> <input id="text4" readonly/> <div class="custom_slider" value={{"equalizer4"}}></div></div>
            <div class="custom five"> <input id="text5" readonly/> <div class="custom_slider" value={{"equalizer5"}}></div></div>
            <div class="custom six"> <input id="text6" readonly/> <div class="custom_slider" value={{"equalizer6"}}></div></div>
            <div class="custom seven"> <input id="text7" readonly/> <div class="custom_slider" value={{"equalizer7"}}></div></div>
            <div class="custom eight"> <input id="text8" readonly/> <div class="custom_slider" value={{"equalizer8"}}></div></div>
            <div class="custom nine"> <input id="text9" readonly/> <div class="custom_slider" value={{"equalizer9"}}></div></div>
            <div class="custom ten"> <input id="text10" readonly/> <div class="custom_slider" value={{"equalizer10"}}></div></div>
            <div class="custom eleven"> <input id="text11" readonly/> <div class="custom_slider" value={{"equalizer11"}}></div></div>
            <div class="custom twelve"> <input id="text12" readonly/> <div class="custom_slider" value={{"equalizer12"}}></div></div>
            <div class="custom thirteen"> <input id="text13" readonly/> <div class="custom_slider" value={{"equalizer13"}}></div></div>
            <div class="custom fourteen"> <input id="text14" readonly/> <div class="custom_slider" value={{"equalizer14"}}></div></div>
            <div class="custom fifteen"> <input id="text15" readonly/> <div class="custom_slider" value={{"equalizer15"}}></div></div>
            <div class="custom sixteen"> <input id="text16" readonly/> <div class="custom_slider" value={{"equalizer16"}}></div></div>
            <div class="custom seventeen"> <input id="text17" readonly/> <div class="custom_slider" value={{"equalizer17"}}></div></div>
            <div class="custom eighteen"> <input id="text18" readonly/> <div class="custom_slider" value={{"equalizer18"}}></div></div>
            <div class="custom nineteen"> <input id="text19" readonly/> <div class="custom_slider" value={{"equalizer19"}}></div></div>
            <div class="custom twenty"> <input id="text20" readonly/> <div class="custom_slider" value={{"equalizer20"}}></div></div>
            <div class="custom twentyone"> <input id="text21" readonly/> <div class="custom_slider" value={{"equalizer21"}></div></div>
          </div>
        </div>
      </div>

      <div class="card-actions">
        <paper-button on-click="_setEqualizerClicked">set equalizer</paper-button>
      </div>
    </paper-card>
    <paper-toast id="toast">Equalizer set to <span>{{iirConstantsString}}</span></paper-toast>
  </template>
  <script>
  var iirConstants = [];
  for(loopVar = 0; loopVar < 21; loopVar++) { // watch out! we got a static over here
    console.log("hi");
    iirConstants[loopVar] = 0;
  }
  console.log(iirConstants);
    Polymer({
      is: 'equalizer-controller',
      
      properties: {
        internalEqualizer: String,

        equalizer: {
          type: String,
          notify: true,
          observer: '_setInternalEqualizer'
        },

        speakerId: {
          type: Number
        }
      },

      _setInternalEqualizer: function(iirConstantsString) {
        this.internalEqualizer = iirConstantsString;
        console.log("_setInternalEqualizer " + iirConstantsString);
      },
      
      _setEqualizerClicked: function() {
        
        this.equalizer = iirConstants.join(" ");  // this gets sent to the backend because Go's Fields(String) function works only with whitespaces
        this.iirConstantsString = iirConstants.join(", ");  // this is for the toast message
        this.$.toast.show();
        console.log("_setEqualizerClicked");
        
        console.log(iirConstants);
      },
      /*
      decrementVolume: function() {
        this.$.volume2.decrement();
        this.$.volume2._expandKnob();
        if(this.prevTimeout != 0) {
          window.clearTimeout(this.prevTimeout)
        }
        var elem = this;
        var func = this.resetKnob;
        this.prevTimeout = window.setTimeout(function(){
          func(elem);
        }, 500);
      },
      
      incrementVolume: function() {
        this.$.volume2.increment();
        this.$.volume2._expandKnob();
        if(this.prevTimeout != 0) {
          window.clearTimeout(this.prevTimeout)
        }
        var elem = this;
        var func = this.resetKnob;
        this.prevTimeout = window.setTimeout(function(){
          func(elem);
        }, 500);
      },*/
      
      resetKnob: function(elem) {
        elem.prevTimeout = 0;
        elem.$.volume2._resetKnob();
      },

      ready: function() {
        this.internalEqualizer = this.iirConstantsString;
      }
    });

// there was some script endings and shit here, putem back if shit fucks up

  var MIN_WIDTH_SUPPORTED = 0;
  var MIN_HEIGHT_SUPPORTED = 0;
  //console.log(navigator);

  if($(window).width() > MIN_WIDTH_SUPPORTED || $(window).height() > MIN_HEIGHT_SUPPORTED) {
    /*$(function() {
      $( ".custom > .custom_slider" ).slider({
        orientation: "vertical",
        range: "min",
        min: 0,
        max: 20,
        value: 10,
        slide: function( event, ui) {
          var inputs = document.getElementsByClassName("custom");
          var handles = document.getElementsByClassName("ui-slider-handle ui-state-default ui-corner-all");
          console.log($(handles[0]).offsetParent().offsetParent());
          var split = handles[0].className;
          console.log($(inputs));

          $( "#text1" ).val( $(inputs[0]).find(".ui-slider-range-min").prop("clientHeight")/10);
          $( "#text2" ).val( $(inputs[1]).find(".ui-slider-range-min").prop("clientHeight")/10);
          $( "#text3" ).val( $(inputs[2]).find(".ui-slider-range-min").prop("clientHeight")/10);
          $( "#text4" ).val( $(inputs[3]).find(".ui-slider-range-min").prop("clientHeight")/10);
          $( "#text5" ).val( $(inputs[4]).find(".ui-slider-range-min").prop("clientHeight")/10);
          $( "#text6" ).val( $(inputs[5]).find(".ui-slider-range-min").prop("clientHeight")/10);
          $( "#text7" ).val( $(inputs[6]).find(".ui-slider-range-min").prop("clientHeight")/10);
          $( "#text8" ).val( $(inputs[7]).find(".ui-slider-range-min").prop("clientHeight")/10);
          $( "#text9" ).val( $(inputs[8]).find(".ui-slider-range-min").prop("clientHeight")/10);
          $( "#text10" ).val( $(inputs[9]).find(".ui-slider-range-min").prop("clientHeight")/10);
          $( "#text11" ).val( $(inputs[10]).find(".ui-slider-range-min").prop("clientHeight")/10);
          $( "#text12" ).val( $(inputs[11]).find(".ui-slider-range-min").prop("clientHeight")/10);

          //console.log(document.getElementById("text3").value);
          //console.log(ui);
          //console.log($(this).offsetParent());
          //console.log($(this).offsetParent().attr('className'));
          //console.log($('#selectable .ui-selected').attr('id'));
        }
      });*/

// try this shit out mayne: http://jqueryrain.com/?MnbPPsmf

    $(function() {
      $( ".custom.one > .custom_slider" ).slider({
        orientation: "vertical",
        range: "min",
        //step: .5,
        min: -40,
        max: 10,
        value: 0,
        slide: function( event, ui) {
          $( "#text1" ).val( ui.value);
          iirConstants[0] = ui.value;
          console.log(iirConstants[0] + " - | - " + ui.value);
        }
      });
      $( ".custom.two > .custom_slider" ).slider({
        orientation: "vertical",
        range: "min",
        min: -40,
        max: 10,
        value: 0,
        slide: function( event, ui) {
          $( "#text2" ).val( ui.value);
          iirConstants[1] = ui.value;
          console.log(iirConstants[1] + " - | - " + ui.value);
        }
      });
      $( ".custom.three > .custom_slider" ).slider({
        orientation: "vertical",
        range: "min",
        min: -40,
        max: 10,
        value: 0,
        slide: function( event, ui) {
          $( "#text3" ).val( ui.value);
          iirConstants[2] = ui.value;
          console.log(iirConstants[2] + " - | - " + ui.value);
        }
      });
      $( ".custom.four > .custom_slider" ).slider({
        orientation: "vertical",
        range: "min",
        min: -40,
        max: 10,
        value: 0,
        slide: function( event, ui) {
          $( "#text4" ).val( ui.value);
          iirConstants[3] = ui.value;
          console.log(iirConstants[3] + " - | - " + ui.value);
        }
      });
      $( ".custom.five > .custom_slider" ).slider({
        orientation: "vertical",
        range: "min",
        min: -40,
        max: 10,
        value: 0,
        slide: function( event, ui) {
          $( "#text5" ).val( ui.value);
          iirConstants[4] = ui.value;
          console.log(iirConstants[4] + " - | - " + ui.value);
        }
      });
      $( ".custom.six > .custom_slider" ).slider({
        orientation: "vertical",
        range: "min",
        min: -40,
        max: 10,
        value: 0,
        slide: function( event, ui) {
          $( "#text6" ).val( ui.value);
          iirConstants[5] = ui.value;
          console.log(iirConstants[5] + " - | - " + ui.value);
        }
      });
      $( ".custom.seven > .custom_slider" ).slider({
        orientation: "vertical",
        range: "min",
        min: -40,
        max: 10,
        value: 0,
        slide: function( event, ui) {
          $( "#text7" ).val( ui.value);
          iirConstants[6] = ui.value;
          console.log(iirConstants[6] + " - | - " + ui.value);
        }
      });
      $( ".custom.eight > .custom_slider" ).slider({
        orientation: "vertical",
        range: "min",
        min: -40,
        max: 10,
        value: 0,
        slide: function( event, ui) {
          $( "#text8" ).val( ui.value);
          iirConstants[7] = ui.value;
          console.log(iirConstants[7] + " - | - " + ui.value);
        }
      });
      $( ".custom.nine > .custom_slider" ).slider({
        orientation: "vertical",
        range: "min",
        min: -40,
        max: 10,
        value: 0,
        slide: function( event, ui) {
          $( "#text9" ).val( ui.value);
          iirConstants[8] = ui.value;
          console.log(iirConstants[8] + " - | - " + ui.value);
        }
      });
      $( ".custom.ten > .custom_slider" ).slider({
        orientation: "vertical",
        range: "min",
        min: -40,
        max: 10,
        value: 0,
        slide: function( event, ui) {
          $( "#text10" ).val( ui.value);
          iirConstants[9] = ui.value;
          console.log(iirConstants[9] + " - | - " + ui.value);
        }
      });
      $( ".custom.eleven > .custom_slider" ).slider({
        orientation: "vertical",
        range: "min",
        min: -40,
        max: 10,
        value: 0,
        slide: function( event, ui) {
          $( "#text11" ).val( ui.value);
          iirConstants[10] = ui.value;
          console.log(iirConstants[10] + " - | - " + ui.value);
        }
      });
      $( ".custom.twelve > .custom_slider" ).slider({
        orientation: "vertical",
        range: "min",
        min: -40,
        max: 10,
        value: 0,
        slide: function( event, ui) {
          $( "#text12" ).val( ui.value);
          iirConstants[11] = ui.value;
          console.log(iirConstants[11] + " - | - " + ui.value);
        }
      });
      $( ".custom.thirteen > .custom_slider" ).slider({
        orientation: "vertical",
        range: "min",
        min: -40,
        max: 10,
        value: 0,
        slide: function( event, ui) {
          $( "#text13" ).val( ui.value);
          iirConstants[12] = ui.value;
          console.log(iirConstants[12] + " - | - " + ui.value);
        }
      });
      $( ".custom.fourteen > .custom_slider" ).slider({
        orientation: "vertical",
        range: "min",
        min: -40,
        max: 10,
        value: 0,
        slide: function( event, ui) {
          $( "#text14" ).val( ui.value);
          iirConstants[13] = ui.value;
          console.log(iirConstants[13] + " - | - " + ui.value);
        }
      });
      $( ".custom.fifteen > .custom_slider" ).slider({
        orientation: "vertical",
        range: "min",
        min: -40,
        max: 10,
        value: 0,
        slide: function( event, ui) {
          $( "#textfifteen" ).val( ui.value);
          iirConstants[14] = ui.value;
          console.log(iirConstants[14] + " - | - " + ui.value);
        }
      });
      $( ".custom.sixteen > .custom_slider" ).slider({
        orientation: "vertical",
        range: "min",
        min: -40,
        max: 10,
        value: 0,
        slide: function( event, ui) {
          $( "#text16" ).val( ui.value);
          iirConstants[15] = ui.value;
          console.log(iirConstants[15] + " - | - " + ui.value);
        }
      });
      $( ".custom.seventeen > .custom_slider" ).slider({
        orientation: "vertical",
        range: "min",
        min: -40,
        max: 10,
        value: 0,
        slide: function( event, ui) {
          $( "#text17" ).val( ui.value);
          iirConstants[16] = ui.value;
          console.log(iirConstants[16] + " - | - " + ui.value);
        }
      });
      $( ".custom.eighteen > .custom_slider" ).slider({
        orientation: "vertical",
        range: "min",
        min: -40,
        max: 10,
        value: 0,
        slide: function( event, ui) {
          $( "#text18" ).val( ui.value);
          iirConstants[17] = ui.value;
          console.log(iirConstants[17] + " - | - " + ui.value);
        }
      });
      $( ".custom.nineteen > .custom_slider" ).slider({
        orientation: "vertical",
        range: "min",
        min: -40,
        max: 10,
        value: 0,
        slide: function( event, ui) {
          $( "#text19" ).val( ui.value);
          iirConstants[18] = ui.value;
          console.log(iirConstants[18] + " - | - " + ui.value);
        }
      });
      $( ".custom.twenty > .custom_slider" ).slider({
        orientation: "vertical",
        range: "min",
        min: -40,
        max: 10,
        value: 0,
        slide: function( event, ui) {
          $( "#text20" ).val( ui.value);
          iirConstants[19] = ui.value;
          console.log(iirConstants[19] + " - | - " + ui.value);
        }
      });
      $( ".custom.twentyone > .custom_slider" ).slider({
        orientation: "vertical",
        range: "min",
        min: -40,
        max: 10,
        value: 0,
        slide: function( event, ui) {
          $( "#text21" ).val( ui.value);
          iirConstants[20] = ui.value;
          console.log(iirConstants[20] + " - | - " + ui.value);
        }
      });

      $( "#text1" ).val( $( ".custom > .custom_slider" ).slider( "value" ) );
      $( "#text2" ).val( $( ".custom > .custom_slider" ).slider( "value" ) );
      $( "#text3" ).val( $( ".custom > .custom_slider" ).slider( "value" ) );
      $( "#text4" ).val( $( ".custom > .custom_slider" ).slider( "value" ) );
      $( "#text5" ).val( $( ".custom > .custom_slider" ).slider( "value" ) );
      $( "#text6" ).val( $( ".custom > .custom_slider" ).slider( "value" ) );
      $( "#text7" ).val( $( ".custom > .custom_slider" ).slider( "value" ) );
      $( "#text8" ).val( $( ".custom > .custom_slider" ).slider( "value" ) );
      $( "#text9" ).val( $( ".custom > .custom_slider" ).slider( "value" ) );
      $( "#text10" ).val( $( ".custom > .custom_slider" ).slider( "value" ) );
      $( "#text11" ).val( $( ".custom > .custom_slider" ).slider( "value" ) );
      $( "#text12" ).val( $( ".custom > .custom_slider" ).slider( "value" ) );
      $( "#text13" ).val( $( ".custom > .custom_slider" ).slider( "value" ) );
      $( "#text14" ).val( $( ".custom > .custom_slider" ).slider( "value" ) );
      $( "#text15" ).val( $( ".custom > .custom_slider" ).slider( "value" ) );
      $( "#text16" ).val( $( ".custom > .custom_slider" ).slider( "value" ) );
      $( "#text17" ).val( $( ".custom > .custom_slider" ).slider( "value" ) );
      $( "#text18" ).val( $( ".custom > .custom_slider" ).slider( "value" ) );
      $( "#text19" ).val( $( ".custom > .custom_slider" ).slider( "value" ) );
      $( "#text20" ).val( $( ".custom > .custom_slider" ).slider( "value" ) );
      $( "#text21" ).val( $( ".custom > .custom_slider" ).slider( "value" ) );
    });

  } else {
      console.log("there is not enough space to display the equalizer");

      window.onload = function(){
        // Use this for loading a different thing when the window loads and the viewport is too small
      };      
    }
  $(window).resize(function() {
    if($(window).width() < MIN_WIDTH_SUPPORTED || $(window).height() < MIN_HEIGHT_SUPPORTED){
      console.log($(window).width());
      /*var custom_container = document.getElementById("custom_container");
      //custom_container.style.visibility = "hidden";
      var customs = document.getElementsByClassName("custom");
      console.log(customs);
      for (i in customs) {
        //document.getElementById("one").style.width = "30px";
        //document.getElementById("custom_container").style.width = "350px";
      }*/
    } else {
      var custom_container = document.getElementById("custom_container");
      //custom_container.style.visibility = "visible";
    }
  });

</script>
</dom-module>